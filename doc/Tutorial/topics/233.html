<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>9.1.3 Using esProc in Excel</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h3 style='margin-left:0cm;text-indent:0cm;mso-list:none;tab-stops:21.0pt'><span
lang=EN-US>9.1.3 Using esProc in Excel</span></h3></div>
	<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='background:aqua;mso-highlight:aqua'>The
features explained in this section only appear in esProc Desktop edition. Users
using the other editions can choose to skip them.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>The basic form of spl() function is spl(<i>exp</i>).
Compute the expression in esProc and return the result. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=98
src="Tutorial.files/image937.png" v:shapes="Í¼Æ¬_x0020_1733"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Enter =spl(&quot;=5.(rand(10))&quot;) in
cell A1 in the above Excel file. The esProc expression &quot;=5.(rand(10))&quot;
is a string headed by the equals sign. Then press <span class=T-Bold>Enter</span>,
confirm the expression, and get the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=98
src="Tutorial.files/image938.png" v:shapes="Í¼Æ¬_x0020_1734"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>A random integer within 10 is entered into
A1. Actually, the result of computing A1¡¯s expression should have been a
sequence. If you need to return the whole result, press <span class=T-Bold>Ctrl+Enter
</span>while confirming the expression. Reselect cell A1 and press Ctrl+Enter
at the same time to get the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image939.png" v:shapes="Í¼Æ¬_x0020_1735"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Now A1¡¯s expression is recomputed and the
result sequence is entered to the Excel spreadsheet.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>We can add parameters to spl() function in
the form of <span class=T-Bold><i><span style='font-weight:normal;mso-bidi-font-weight:
bold'>spl(</span></i></span><span class=var0><span style='font-weight:normal;
mso-bidi-font-weight:bold;font-style:normal;mso-bidi-font-style:italic'>exp</span></span><span
class=T-Bold><i><span style='font-weight:normal;mso-bidi-font-weight:bold'>, </span></i></span><span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold;
font-style:normal;mso-bidi-font-style:italic'>arg1</span></span><span
class=T-Bold><i><span style='font-weight:normal;mso-bidi-font-weight:bold'>,¡­)</span></i></span>,
which is similar to the use of eval() function. We use quotation marks (?) to
represent the parameters in the expression in order; or use <span class=T-Bold><span
style='font-weight:normal;mso-bidi-font-weight:bold'>?</span></span><span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold'>n</span></span><b>
</b>to represent the n<sup>th</sup> parameter. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image940.png" v:shapes="Í¼Æ¬_x0020_1736"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Compute the average score of two tests
using spl() function in D2. The expression can also be written as =spl(&quot;(?1+?2)/2&quot;,A2,B2),
which returns the following result after execution:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image941.png" v:shapes="Í¼Æ¬_x0020_1737"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>If we select D2 at the left corner and
drag it to D4, its expression will apply to the whole selected area, where
parameters will be adjusted according to position:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image942.png" v:shapes="Í¼Æ¬_x0020_1738"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>When using esProc add-ins in Excel, we
often use E() function to generate a table sequence. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image943.png" v:shapes="Í¼Æ¬_x0020_1739"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>When the parameter of spl() function is
set up as a stretch of cells in the Excel file, data items in them will be
transformed to a two-dimensional sequence and passed to esProc for computation.
It is convenient to do this with E() function. To type in formula =spl(&quot;=E(?)&quot;,A1:B4)
in D1 and press Ctrl+Enter to get the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image944.png" v:shapes="Í¼Æ¬_x0020_1740"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>When result of computing spl() function is
entered, it overwrites the original data in the Excel spreadsheet. So, you need
to pay special attention to it. The spl() function can perform more
computations on the table sequence generated by E() function and get the
expected result. To modify D2¡¯s expression into =spl(&quot;=E(?).derive((#1+#2)/2:Avg)&quot;,A1:B4),
for example, and press Ctrl+Enter to get the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=462 height=175
src="Tutorial.files/image945.png" v:shapes="Í¼Æ¬_x0020_1741"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>There is another point. Different from
Java, Excel uses its own format for datetime data. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=460 height=122
src="Tutorial.files/image946.png" v:shapes="Í¼Æ¬_x0020_1757"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Execute the statement and get the
following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=460 height=122
src="Tutorial.files/image947.png" v:shapes="Í¼Æ¬_x0020_1758"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>esProc gets a date data in a different
format from that in Excel, which uses a unique datetime format. We can use <span
class=T-Bold><span style='font-weight:normal;mso-bidi-font-weight:bold'>E(</span></span><span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold'>x</span></span><span
class=T-Bold><span style='font-weight:normal;mso-bidi-font-weight:bold'>)</span>
</span>function in a spl statement to convert an Excel date specified by <span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold'>x</span></span>
to a generally used format. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=460 height=122
src="Tutorial.files/image948.png" v:shapes="Í¼Æ¬_x0020_1759"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Execute the statement and get the
following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=460 height=122
src="Tutorial.files/image949.png" v:shapes="Í¼Æ¬_x0020_1760"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Note that results of both B1 and B2 are
actually strings displayed in esProc, which are different from the Excel format
date data. If you need to an Excel format date, just use <span class=T-Bold><span
style='font-weight:normal;mso-bidi-font-weight:bold'>E(</span></span><span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold'>x</span></span><span
class=T-Bold><span style='font-weight:normal;mso-bidi-font-weight:bold'>)</span>
</span>function again to convert a general format date specified by <span
class=var0><span style='font-weight:normal;mso-bidi-font-weight:bold'>x</span></span>
to an Excel datetime, as shown below:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=391 height=149
src="Tutorial.files/image950.png" v:shapes="Í¼Æ¬_x0020_1761"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>Execute the statement and get the
following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=391 height=149
src="Tutorial.files/image951.png" v:shapes="Í¼Æ¬_x0020_1762"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>The value of B3 is a number, which is the
actual value for the Excel date. Once B3¡¯s format is set as date, the date can
be displayed normally:</span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US><img border=0 width=391 height=149
src="Tutorial.files/image952.png" v:shapes="Í¼Æ¬_x0020_1763"></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0'><span
lang=EN-US>Find more about executing Excel data handling in esProc in <a
href="http://c.raqsoft.com/article/1651916536524">esProc Desktop and Excel Pro<span
style='mso-bookmark:_Hlt165037721'><span style='mso-bookmark:_Hlt165037722'>c</span></span>essing</a><a
name="_Hlt165037722"></a><a name="_Hlt165037721"></a>.</span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="234.html">Next</a></div>
		<div id="previous"><a href="232.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="231.html">9.1.1 Using Excel file data</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">SCUDATA Ltd. 
      </a></div>
	</div>
</div>

</body>
</html>
