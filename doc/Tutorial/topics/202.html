<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>7.8.2 Retrieving data with the cursor by segment</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h3 style='margin:0cm;text-indent:0cm;line-height:normal;mso-list:none;
tab-stops:-179.95pt 64.2pt'><span lang=EN-US style='font-size:14.0pt;
mso-bidi-font-size:10.0pt'>7.8.2 Retrieving data with the cursor by segment</span></h3></div>
	<p class=T-Par style='margin-bottom:0cm;mso-add-space:auto;text-align:justify;
text-justify:inter-ideograph;text-indent:21.0pt'><span lang=EN-US>It is a
common approach to split a big data file into segments and then compute each
segment separately. Both text files and bin files can be imported by segment by
adding a file segmentation parameter. <i style='mso-bidi-font-style:normal'><a
 href="196.html">Text Files</a></i> explains generating a text-based table
sequence by importing data by segment. Importing data through cursor is almost
identical. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:21.0pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=42 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=302 valign=top style='width:226.75pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>A</span><span
  lang=EN-US style='font-size:9.0pt'></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>1</span><span
  lang=EN-US style='font-size:9.0pt'></span></p>
  </td>
  <td width=302 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=file(&quot;PersonnelInfo.btx&quot;)</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>2</span><span
  lang=EN-US style='font-size:9.0pt'></span></p>
  </td>
  <td width=302 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A1.cursor@b(;1:5)</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>3</span><span
  lang=EN-US style='font-size:9.0pt'></span></p>
  </td>
  <td width=302 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A2.fetch()</span><span lang=EN-US
  style='font-family:"Times New Roman",serif'></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>4</span><span
  lang=EN-US style='font-size:9.0pt'></span></p>
  </td>
  <td width=302 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A1.cursor@b(;2:5)</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='color:black;mso-color-alt:windowtext'>5</span></p>
  </td>
  <td width=302 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A4.fetch()</span><span lang=EN-US
  style='font-family:"Times New Roman",serif'></span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='margin-bottom:0cm;mso-add-space:auto;text-align:
justify;text-justify:inter-ideograph;text-indent:21.0pt'><span lang=EN-US>Both
A2 and A4, when generating the cursor, use a file segmentation parameter, such
as 1:5. When data is retrieved from a bin file by segment, the file needs to be
pre-handled by the <b style='mso-bidi-font-weight:normal'><span
style='color:black'>export@z </span></b>function. That means the <b
style='mso-bidi-font-weight:normal'>export()</b> function uses the <b
style='mso-bidi-font-weight:normal'>@z</b> option to generate the <i
style='mso-bidi-font-style:normal'>PersonnelInfo.btx</i> file. According to the
file segmentation parameter, the cursor data is divided into 5 parts. A2
returns the 1st part and A4 returns the 2nd part. A3 and A5 fetch data
respectively as follows:</span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;mso-add-space:auto;
text-align:justify;text-justify:inter-ideograph;text-indent:21.0pt'><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=500 height=230
src="Tutorial.files/image769.png" v:shapes="_x0000_i1877"></span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;mso-add-space:auto;
text-align:justify;text-justify:inter-ideograph;text-indent:21.0pt'><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=500 height=230
src="Tutorial.files/image770.png" v:shapes="_x0000_i1878"></span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;mso-add-space:auto;
text-align:justify;text-justify:inter-ideograph;text-indent:21.0pt'><span
lang=EN-US>The <span class=T-Bold><i style='mso-bidi-font-style:normal'>PersonnelInfo.btx</i></span>
file has 100,000 records in total. The five parts into which it is divided are approximately
same in sizes but don¡¯t necessary contain the same number of records<span
style='color:black'>. </span><span class=T-Bold>When performing segmental
retrieval, esProc can automatically adjust the range of data being retrieved so
as to ensure the data integrity, as with</span> the 1st and the 2nd segments in
the exaple. This will ensure the continuity and uniqueness of the data that is
being handled.</span></p>

<p class=T-ParCxSpLast style='margin-bottom:0cm;mso-add-space:auto;text-align:
justify;text-justify:inter-ideograph;text-indent:21.0pt'><span lang=EN-US>It¡¯s
the same way to perform segmental retrieval on a text file and a bin file,
except that <b style='mso-bidi-font-weight:normal'>@b</b> option will be
omitted for the former. While retrieving data by segment from a bin file, the
file can be divided into multiple segments corresponding to different groups of
data through <b style='mso-bidi-font-weight:normal'>@z</b> option. For detailed
information, see <i style='mso-bidi-font-style:normal'><a  href="203.html">Group
Cursor</a></i>. Segmenting data by group is a feature uniquely applied to bin
files; it can¡¯t be used on text files. </span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="203.html">Next</a></div>
		<div id="previous"><a href="201.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="200.html">7.8 Bin Files</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		<div class="copyright"> Copyright&reg; 2021 <a href="http://www.scudata.com" target="_Blank">SCUDATA Inc. 
      </a></div> 
        <!--
		<div class="copyright"> Copyright&reg; 2017 <a href="http://www.yimming.com" target="_Blank"> Beijing Yimming Ltd. Co. 
      </a></div>
	  -->
	</div>
</div>

</body>
</html>
