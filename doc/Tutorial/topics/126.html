<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>4.3.2 Commit and rollback transaction management</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h3 style='margin:0cm;margin-bottom:.0001pt;text-indent:0cm;line-height:normal;
mso-list:none;tab-stops:-179.95pt 64.2pt'><span lang=EN-US style='font-size:
14.0pt;mso-bidi-font-size:10.0pt'>4.3.2 Commit and rollback transaction
management</span></h3></div>
	<p class=T-ParCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>Whether a batch update will be successful and which
record could cause an error are unpredicatable because each record update is
automatically committed.This is bad for database management. </span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>Sometimes whether a database upadate transaction
should be committed or canceled depends on the current situation. </span><span
class=var><b style='mso-bidi-font-weight:normal'><span lang=EN-US>db</span></b></span><span
class=T-CodeChar><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>.commit()</span></span><span lang=EN-US> and </span><span
class=var><b style='mso-bidi-font-weight:normal'><span lang=EN-US>db</span></b></span><span
class=T-CodeChar><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>.rollback() functions are used to perform commit and
rollback respectively. </span></span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US></span></b></p>

<p class=T-ParCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>By default, the execution of an esProc statement is
committed automatically and beyond control. In order to control the transaction
commitment through </span><span class=var><b style='mso-bidi-font-weight:normal'><span
lang=EN-US>db</span></b></span><span class=T-CodeChar><span lang=EN-US
style='font-family:"Times New Roman",serif'>.commit()</span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US> </span></b><span
lang=EN-US>and </span><span class=var><b style='mso-bidi-font-weight:normal'><span
lang=EN-US>db</span></b></span><span class=T-CodeChar><span lang=EN-US
style='font-family:"Times New Roman",serif'>.rollback()</span></span><span
class=T-CodeChar><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>, @k option is added to an execute or update statement to
decide which function should be used. Data validity is determined according to
the error value. As the following example shows, if an error occurs during
batch update, the transaction will be aborted. In this way, the database can be
saved from receiving any unpredictable results: </span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US></span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:20.0pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:14.15pt'>
  <td width=42 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0'><span lang=EN-US
  style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>A</span></p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>B</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>1</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:windowtext;
  mso-border-left-alt:windowtext;mso-border-bottom-alt:#B2B2B2;mso-border-right-alt:
  #B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:.5pt;background:#FFFF99;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>=demo.query(&quot;select
  * from CITIES&quot;)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>2</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>=connect@e(&quot;DbCon&quot;)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>3</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.execute(&quot;delete
  from CityBak&quot;)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>4</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.update@k(A1,CityBak,ID:CID,CITY:NAME,POPULATION,STATE:STATEID)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>5</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>if
  A2.error()==0</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.commit()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>6</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>else</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.rollback()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>7</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>=A2.query(&quot;select
  * from CityBak&quot;)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>8</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.update@k(A1.to(5),CityBak,ID:CID,
  CITY:NAME,POPULATION,STATE:STATEID)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>9</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>if
  A2.error()==0</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.commit()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>10</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>else</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.rollback()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>11</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>=A2.query(&quot;select
  * from CityBak&quot;)</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12;mso-yfti-lastrow:yes;height:14.15pt'>
  <td width=42 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd10><span lang=EN-US>12</span></p>
  </td>
  <td width=227 style='width:6.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:
  14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  line-height:normal'><span lang=EN-US style='font-family:"Times New Roman",serif'>&gt;A2.close()</span></p>
  </td>
  <td width=113 style='width:3.0cm;border-top:none;border-left:none;border-bottom:
  solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;mso-border-top-alt:solid #B2B2B2 .5pt;
  mso-border-left-alt:solid #B2B2B2 .5pt;mso-border-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph;
  text-indent:18.0pt;mso-char-indent-count:2.0;line-height:normal'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>A3 deletes data from <span class=T-Bold><i
style='mso-bidi-font-style:normal'><span style='font-weight:normal'>CityBak</span></i></span><span
class=T-Bold><span style='font-weight:normal'>. It commits the transaction
automatically because @k option is absent in </span></span></span><span
class=var><b style='mso-bidi-font-weight:normal'><span lang=EN-US>db</span></b></span><span
class=T-CodeChar><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>.</span></span><span class=T-CodeChar><span lang=EN-US
style='font-family:"Times New Roman",serif'>execute().</span></span><span
lang=EN-US> An error occurs in A4 when batch update is executing and shown in
A5:<b style='mso-bidi-font-weight:normal'></b></span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=100 height=41
src="Tutorial.files/image035.png" v:shapes="_x0000_i1703"></span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>So the rollback operation in B6, instead of the commit
operation in B5, is executed. The query result in A7 is as follows: </span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=419 height=60
src="Tutorial.files/image599.png" v:shapes="_x0000_i1704"></span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>If there¡¯s no error during a batch update with the use
of <b style='mso-bidi-font-weight:normal'>@k</b> option, like the statement
executed in A8, you can know according to the error value. Here¡¯s A9¡¯s value:</span></p>

<p class=T-ParCxSpMiddle style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=100 height=41
src="Tutorial.files/image034.png" v:shapes="_x0000_i1705"></span></p>

<p class=T-ParCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
mso-add-space:auto;text-align:justify;text-justify:inter-ideograph;text-indent:
21.0pt'><span lang=EN-US>In this case, the commit operation in B9 will be
executed and data will be written to the database. The query result of A11 is
as follows:</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0'><span
lang=EN-US style='mso-no-proof:yes'><img border=0 width=383 height=121
src="Tutorial.files/image604.png" v:shapes="_x0000_i1706"></span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="127.html">Next</a></div>
		<div id="previous"><a href="125.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="124.html">4.3 Database Connection Management</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">SCUDATA Ltd. 
      </a></div>
	</div>
</div>

</body>
</html>
