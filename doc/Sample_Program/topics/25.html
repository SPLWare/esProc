<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>13. Employees Who Have Taken a Leave Longer Than 2 Consecutive Days Three Times in a Year</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h2 style='mso-list:l22 level1 lfo40'><span lang=X-NONE
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><span
lang=X-NONE>Employees Who Have Taken a Leave Longer Than 2 Consecutive Days Three
Times in a Year</span><span
lang=EN-US> </span></h2></div>
	<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;line-height:
16.0pt;mso-line-height-rule:exactly;mso-list:l24 level2 lfo12'><span
lang=EN-US style='mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-fareast-font-family:
Wingdings;mso-bidi-font-family:Wingdings'><span style='mso-list:Ignore'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
12.0pt'>Problem</span></b></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>The </span><span class=code><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>LeaveRecords</span></i></span><span lang=EN-US
style='mso-bidi-font-size:10.5pt'> table is used to record the leaves of employees
in 2009, including the start date and end date for each leave of every
employee. </span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;mso-no-proof:yes'><img width=290 height=269
src="Sample_Program.files/image069.gif" alt=25-1 v:shapes="Í¼Æ¬_x0020_112"></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'></span></p>

<p class=MsoNormal style='text-indent:17.85pt;mso-char-indent-count:1.7'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>The </span><span class=code><span lang=EN-US
style='font-family:"Times New Roman",serif'>Employees</span></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'> table is as below:</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;mso-no-proof:yes'><img width=466 height=269
src="Sample_Program.files/image070.gif" alt=9-1 v:shapes="Í¼Æ¬_x0020_113"></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'></span></p>

<p class=MsoNormal style='text-indent:17.85pt;mso-char-indent-count:1.7'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>Please find </span><span
class=code><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>employees</span></span><span lang=EN-US style='mso-bidi-font-size:
10.5pt'> who have asked for a leave longer than two consecutive days 3 times
within the year.</span></p>

<p class=MsoNormal style='text-indent:17.85pt;mso-char-indent-count:1.7;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;line-height:
16.0pt;mso-line-height-rule:exactly;mso-list:l24 level2 lfo12'><span
lang=EN-US style='mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-fareast-font-family:
Wingdings;mso-bidi-font-family:Wingdings'><span style='mso-list:Ignore'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
12.0pt'>Tip</span></b></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>General steps: Firstly, compute the duration
of each leave for every record in the </span><span class=code><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
font-weight:normal'>LeaveRecords</span></i></span><span lang=EN-US
style='mso-bidi-font-size:10.5pt'> table. Then by using the coordinate
translation of the sequence, search for the consecutive 3 records with the
durations of leaves longer than 2 days.</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>1.<span style='mso-tab-count:1'>&nbsp; </span>Group
the </span><span class=code><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-family:"Times New Roman",serif;font-weight:normal'>LeaveRecords</span></i></span><b
style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'> </span></i></b><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>table by Employee, and create a new table
sequence including the Length field. Calculate the duration of each leave and
create a sequence composed of these results. </span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>2.<span style='mso-tab-count:1'>&nbsp; </span>Call
the select function to filter out the consecutive 3 records with the Length value
greater than 2</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02;
line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>3.<span style='mso-tab-count:1'>&nbsp; </span>Retrieve
the employee names of the above selected records from the Employees table for
easier viewing.</span></p>

<p class=MsoNormal style='text-indent:17.85pt;mso-char-indent-count:1.7'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;mso-list:l24 level2 lfo12'><span
lang=EN-US style='mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-fareast-font-family:
Wingdings;mso-bidi-font-family:Wingdings'><span style='mso-list:Ignore'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
12.0pt'>Code</span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=518
 style='margin-left:21.0pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;mso-border-alt:
  solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US>&nbsp;</span></p>
  </td>
  <td width=307 style='width:230.5pt;border:solid black 1.0pt;border-left:none;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US style='color:black;mso-color-alt:windowtext'>A</span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US style='color:black;mso-color-alt:windowtext'>1</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=file(&quot;C:\\txt\\LeaveRecords.txt&quot;).import@t()</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>The </span><span class=code><i
  style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  font-weight:normal'>LeaveRecords</span></i></span><span lang=EN-US> table </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US style='color:black;mso-color-alt:windowtext'>2</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=file(&quot;C:\\txt\\Employees.txt&quot;).import@t()</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>The </span><span class=code><i
  style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  font-weight:normal'>Employees</span></i></span><span lang=EN-US> table </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US style='color:black;mso-color-alt:windowtext'>3</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A1.group(Employee;~.(
  interval(StartDate,EndDate)):Length)</span><span lang=EN-US style='font-family:
  "Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>Group the </span><span class=code><i
  style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  font-weight:normal'>LeaveRecords</span></i></span><span lang=EN-US> table by </span><span
  class=code><i style='mso-bidi-font-style:normal'><span lang=EN-US
  style='font-family:"Times New Roman",serif;font-weight:normal'>Employee</span></i></span><span
  lang=EN-US>, and calculate the duration of leave for each record </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel><span lang=EN-US style='color:black;mso-color-alt:windowtext'>4</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A3.select(Length.count(#&gt;2
  &amp;&amp; ~&gt;2 &amp;&amp; Length(#-1)&gt;2 &amp;&amp;
  Length(#-2)&gt;2)&gt;0)</span><span lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>Select the consecutive three records with
  the Length values greater than 2</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;page-break-inside:avoid;height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLaEnd><span lang=EN-US style='color:black;mso-color-alt:windowtext'>5</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A2.keys(ID)</span><span lang=EN-US
  style='font-family:"Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=29 style='width:21.8pt;border:solid black 1.0pt;border-top:none;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLaEnd><span lang=EN-US style='color:black;mso-color-alt:windowtext'>6</span></p>
  </td>
  <td width=307 style='width:230.5pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode><span lang=EN-US style='font-family:"Times New Roman",serif;
  color:black;mso-color-alt:windowtext'>=A4.(A2.find(Employee)).(Name)</span><span
  lang=EN-US style='font-family:"Times New Roman",serif'></span></p>
  </td>
  <td width=181 style='width:136.05pt;border:none;mso-border-left-alt:solid #B2B2B2 .5pt;
  padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabHelp><span lang=EN-US>Replace </span><span class=code><i
  style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Times New Roman",serif;
  font-weight:normal'>ID</span></i></span><span lang=EN-US> with </span><span
  class=code><i style='mso-bidi-font-style:normal'><span lang=EN-US
  style='font-family:"Times New Roman",serif;font-weight:normal'>Name</span></i></span><span
  lang=EN-US> for easier view </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;line-height:
16.0pt;mso-line-height-rule:exactly;mso-list:l24 level2 lfo12'><span
lang=EN-US style='mso-bidi-font-size:12.0pt;font-family:Wingdings;mso-fareast-font-family:
Wingdings;mso-bidi-font-family:Wingdings'><span style='mso-list:Ignore'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
12.0pt'>Result</span></b></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.02'><span
lang=EN-US style='mso-no-proof:yes'><img width=100 height=81
src="Sample_Program.files/image072.jpg" v:shapes="_x0000_i1073"></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="26.html">Next</a></div>
		<div id="previous"><a href="24.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="12.html">Database Computation</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		<div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">Scudata Inc. 
      </a></div> 
        <!--
		<div class="copyright"> Copyright&reg; 2017 <a href="http://www.yimming.com" target="_Blank"> Beijing Yimming Ltd. Co. 
      </a></div>
	  -->
	</div>
</div>

</body>
</html>
