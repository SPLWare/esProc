<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>=expression</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h2><a name=expression><span lang=EN-US>=expression</span></a></h2></div>
	<p class=ad style='line-height:200%'><span lang=EN-US>Description:</span><span
lang=EN-US style='font-weight:normal'></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:black'>Execute a statement </span><span lang=EN-US>through esProc
JDBC<span style='color:black'> and return the result set</span></span></p>

<p class=ad style='line-height:200%'><span lang=EN-US>Syntax:</span><span
lang=EN-US style='font-weight:normal'></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><b><span lang=EN-US>=</span></b><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='mso-bidi-font-weight:
bold'>expression</span></i></p>

<p class=ad style='line-height:200%'><span lang=EN-US>Note:</span><span
lang=EN-US style='font-weight:normal'> </span></p>

<p class=af5 style='text-indent:21.0pt;mso-char-indent-count:0'><span
lang=EN-US style='font-family:"Times New Roman","serif"'>This statement works
similarly to an expression in the esProc calculation cell. The <i
style='mso-bidi-font-style:normal'>Statement</i> can be generated by directly using
<span class=var1>con</span></span><span class=code><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-family:"Times New Roman","serif";
font-weight:normal'>.createStatement()</span></i></span><span lang=EN-US
style='font-family:"Times New Roman","serif"'>. Use <span class=var1>st</span></span><span
class=code><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='font-family:"Times New Roman","serif";font-weight:normal'>.executeQuery()</span></i></span><span
lang=EN-US style='font-family:"Times New Roman","serif"'> to execute the
statement directly, and return the result set. If the statement contains the <i
style='mso-bidi-font-style:normal'>tab/enter</i> separator, a cellset will be
dynamically generated for executing it. Notice that the expression must start
with an equal sign. <span class=var1><span style='font-style:normal;mso-bidi-font-style:
italic'>If there are parameters in the statement, they always start with </span>arg</span><span
class=var1><span style='font-style:normal;mso-bidi-font-style:italic'>.</span></span></span></p>

<p class=ad style='line-height:200%'><span lang=EN-US>Parameter:</span><span
lang=EN-US style='font-weight:normal'> </span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:17.0pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=92 valign=top style='width:55.35pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><i style='mso-bidi-font-style:normal'><span lang=EN-US
  style='mso-bidi-font-weight:bold'>expression</span></i><span class=var1><span
  lang=EN-US></span></span></p>
  </td>
  <td width=590 valign=top style='width:353.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-bidi-font-weight:bold'>SQL
  statement or expression. If there are multiple expressions in the bracket,
  the expressions will be computed one by one and the value of the last
  expression will be returned, for example: (<i style='mso-bidi-font-style:
  normal'>arg1=1,arg2=2,arg1+arg2</i>), the return value is 3</span></p>
  </td>
 </tr>
</table>

<p class=ad style='line-height:200%'><span lang=EN-US>Return value:</span><span
lang=EN-US style='font-weight:normal'> </span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>Result set</span></p>

<p class=ad style='line-height:200%'><span lang=EN-US>Example:</span><span
lang=EN-US style='font-weight:normal'></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
lang=EN-US style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>public</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'> </span><b><span
lang=EN-US style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>void</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>
testDataServer() {</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:
0pt'></span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>Connection con = </span><b><span
lang=EN-US style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>null</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>;</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>java.sql.PreparedStatement
st;</span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>java.sql.Statement
st2;</span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.11;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>try</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>{</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>Class.<i>forName</i>(</span><span
lang=EN-US style='font-size:10.0pt;color:#2A00FF;mso-font-kerning:0pt'>&quot;com.esproc.jdbc.InternalDriver&quot;</span><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>con=DriverManager.<i>getConnection</i>(</span><span
lang=EN-US style='font-size:10.0pt;color:#2A00FF;mso-font-kerning:0pt'>&quot;jdbc:esproc:local://&quot;</span><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>);<span
style='mso-tab-count:1'>&nbsp; </span></span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// Call the stored
procedure</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>st=con.prepareCall(</span><span
lang=EN-US style='font-size:10.0pt;color:#2A00FF;mso-font-kerning:0pt'>&quot;call
test(3)&quot;</span><span lang=EN-US style='font-size:10.0pt;color:black;
mso-font-kerning:0pt'>); </span><span lang=EN-US style='font-size:10.0pt;
mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// Execute
statement directly, return result set</span><span lang=EN-US style='font-size:
10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>ResultSet set =
st.executeQuery(</span><span lang=EN-US style='font-size:10.0pt;color:#2A00FF;
mso-font-kerning:0pt'>&quot;=(arg=3,arg+3)&quot;</span><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// Print results</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>printRs(set);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// Create Statement
directly</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>st2=con.createStatement();<span
style='mso-tab-count:1'>&nbsp; </span><span style='mso-tab-count:
1'>&nbsp; </span><span
style='mso-tab-count:1'>&nbsp; </span></span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>ResultSet set2 =
st2.executeQuery(</span><span lang=EN-US style='font-size:10.0pt;color:#2A00FF;
mso-font-kerning:0pt'>&quot;=(arg=3,arg+4)&quot;</span><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>); </span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>printRs(set2);</span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// If the statement
contains the tab/enter separator, a cellset will be dynamically generated for
executing it</span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>ResultSet b
=st2.executeQuery(</span><span lang=EN-US style='font-size:10.0pt;color:#2A00FF;
mso-font-kerning:0pt'>&quot;==null\nfor 1,11,5\n\t&gt;A1=A1+A2&quot;</span><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>printRs(b); </span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.11;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>catch</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>(Exception
e){</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>System.</span><i><span
lang=EN-US style='font-size:10.0pt;color:#0000C0;mso-font-kerning:0pt'>out</span></i><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>.println(e);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:21.2pt;mso-char-indent-count:2.11;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>finally</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>{</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:#3F7F5F;mso-font-kerning:0pt'>// Close the
connection</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:
0pt'></span></p>

<p class=MsoNormal style='text-indent:42.45pt;mso-char-indent-count:4.23;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>if</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'> (con!=</span><b><span
lang=EN-US style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>null</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>) {</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:63.65pt;mso-char-indent-count:6.34;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>try</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'> {</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:85.0pt;mso-char-indent-count:8.5;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>con.close();</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:63.8pt;mso-char-indent-count:6.38;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:63.65pt;mso-char-indent-count:6.34;
mso-layout-grid-align:none;text-autospace:none'><b><span lang=EN-US
style='font-size:10.0pt;color:#7F0055;mso-font-kerning:0pt'>catch</span></b><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>(Exception
e) {</span><span lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:85.0pt;mso-char-indent-count:8.5;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>System.</span><i><span
lang=EN-US style='font-size:10.0pt;color:#0000C0;mso-font-kerning:0pt'>out</span></i><span
lang=EN-US style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>.println(e);</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:63.8pt;mso-char-indent-count:6.38;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:42.5pt;mso-char-indent-count:4.25;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal style='text-indent:21.3pt;mso-char-indent-count:2.13;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-size:10.0pt;color:black;mso-font-kerning:0pt'>}</span><span
lang=EN-US style='font-size:10.0pt;mso-font-kerning:0pt'></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;color:black;
mso-font-kerning:0pt'>}</span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="52.html">Next</a></div>
		<div id="previous"><a href="50.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ו;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="45.html">Functions</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		<div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">Scudata Inc. 
      </a></div> 
        <!--
		<div class="copyright"> Copyright&reg; 2017 <a href="http://www.yimming.com" target="_Blank"> Beijing Yimming Ltd. Co. 
      </a></div>
	  -->
	</div>
</div>

</body>
</html>
